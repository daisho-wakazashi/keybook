<%# Flash messages %>
<%= turbo_stream.replace "flash" do %>
  <div id="flash">
    <% if flash[:notice] || flash[:alert] %>
      <div class="container mx-auto mt-20 px-5">
        <% if flash[:notice] %>
          <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" role="alert">
            <span class="block sm:inline"><%= flash[:notice] %></span>
          </div>
        <% end %>
        <% if flash[:alert] %>
          <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
            <span class="block sm:inline"><%= flash[:alert] %></span>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
<% end %>

<%# Replace the calendar container with updated data %>
<%= turbo_stream.replace "booking-calendar-container" do %>
  <div id="booking-calendar-container" class="calendar-container" data-controller="tenant-booking-selection">
    <div class="calendar-header">
      <div class="calendar-header-left">
        <h1 class="calendar-title">Book Availability</h1>

        <div class="tenant-booking-controls">
          <p class="tenant-booking-instructions">
            Select an available time slot to book
          </p>
          <div class="tenant-booking-actions">
            <button
              type="button"
              class="tenant-booking-button-book"
              data-action="click->tenant-booking-selection#makeBooking"
              data-tenant-booking-selection-target="bookButton"
              disabled
            >
              Make Booking
            </button>
          </div>
        </div>
      </div>

      <%= render 'calendars/month_selector', calendar_path: ->(date:) { tenants_booking_path(@property_manager, date: date) } %>

      <div class="calendar-header-right">
        <%= link_to 'Today', tenants_booking_path(@property_manager, date: Date.current.to_s), class: "calendar-nav-button-primary" %>
      </div>
    </div>

    <div class="mb-4">
      <h2 class="text-xl font-semibold text-gray-800 mb-2">
        Week:
        <%= @week_start.strftime('%b %d') %> - <%= @week_end.strftime('%b %d, %Y') %>
      </h2>
    </div>

    <%= render 'week_grid_tenant', availabilities: @availabilities %>

    <%= form_with url: tenants_bookings_path, method: :post, data: { tenant_booking_selection_target: "form" } do |f| %>
      <%= f.hidden_field :availability_id, data: { tenant_booking_selection_target: "availabilityInput" } %>
      <%= f.hidden_field :id, value: @property_manager.id %>
    <% end %>
  </div>
<% end %>
